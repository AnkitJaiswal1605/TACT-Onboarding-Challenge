"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.OverwritableVirtualFileSystem = void 0;
const path_1 = require("path");
const fs_1 = require("fs");
class OverwritableVirtualFileSystem {
    constructor(root) {
        this.overwrites = new Map();
        this.root = (0, path_1.normalize)(root);
        if (!this.root.endsWith(path_1.sep)) {
            this.root += path_1.sep;
        }
    }
    resolve(...path) {
        return (0, path_1.normalize)((0, path_1.resolve)(this.root, ...path));
    }
    exists(path) {
        return (0, fs_1.existsSync)(path);
    }
    readFile(path) {
        return this.overwrites.get(path) ?? (0, fs_1.readFileSync)(path);
    }
    writeFile(path, content) {
        this.overwrites.set(path, typeof content === 'string' ? Buffer.from(content, 'utf-8') : content);
    }
}
exports.OverwritableVirtualFileSystem = OverwritableVirtualFileSystem;
